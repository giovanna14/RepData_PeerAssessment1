---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r readdata, echo=TRUE}
## unzip the datafile into a temporary directory 
## and read it into an R data frame called mydata
zipdir <- tempfile()
dir.create(zipdir)
unzip("activity.zip", exdir=zipdir)
files <- list.files(zipdir)
files <- files[grep("\\.csv$", files)] 
myfile <- file.path(zipdir,files[[1]])
mydata <- read.csv(myfile)
```


## What is mean total number of steps taken per day?

```{r originaldata, echo=TRUE}
## total number of steps taken each day
sum_per_date <- tapply(mydata$steps,mydata$date,sum)
hist(sum_per_date,breaks="FD",
     main="Total number of daily steps",
     xlab = "Total steps per day")
## mean and median number of steps per day
mean_med <- c(summary(sum_per_date)[4],summary(sum_per_date)[3])
mean_med
```

In a period of `r (dim(sum_per_date))` days spread over a year,
the mean and median total number of steps taken per day were
`r format.AsIs(mean_med[1])` and `r format.AsIs(mean_med[2])`, 
respectively.

## What is the average daily activity pattern?

```{r,echo=TRUE}
mean_per_int <- aggregate(mydata$steps[!is.na(mydata$steps)],
                          list(interval = mydata$interval[!is.na(mydata$steps)]),
                          mean)
with(mean_per_int, plot(interval,x,type="l",
                        main="Average daily activity pattern",
                        ylab = "Mean steps per time interval",
                        xlab = "Time interval (minutes)"
                        )
     )
max_int <- mean_per_int$interval[mean_per_int$x >= max(mean_per_int$x)]
```

On average, across all the days in the dataset, the maximum number of steps
occurs in the time interval at `r max_int` minutes.

## Imputing missing values

```{r missingvalues, echo=TRUE}
# number of complete observations in the dataset
cc <- complete.cases(mydata)
# number of NAs in the dataset
n_NA <- sum(!cc)
n_NA

list_missing_val <- tapply(mydata$steps, mydata$date, is.na)
missing_val_per_day <- sapply(list_missing_val,sum)
missing <- missing_val_per_day[missing_val_per_day > 0]
missing
```
The number of NAs in the dataset is `r n_NA`. These are in 
`r length(missing)` days during which no valid measurement was taken.  
We decided to fill in missing values in these days by substituting 
for each 5 minutes time interval the mean total number of steps taken 
in that interval. 
We investigate the impact of this strategy of imputing missing data by
calculating the histogram of total daily steps and the mean and median
total number of steps taken per day from the modified dataset and
comparing it with those obtained from the original dataset.

```{r simulatedata, echo=TRUE}
#library(dplyr)
newdata <- merge(mydata,mean_per_int,sort=FALSE)
## to be continued...
```

## Are there differences in activity patterns between weekdays and weekends?

```{r,echo=TRUE}
```


